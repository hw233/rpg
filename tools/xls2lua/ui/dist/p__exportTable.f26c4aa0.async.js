(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[511],{59264:function(pe,C,e){"use strict";e.r(C);var me=e(57106),j=e(99683),De=e(18446),N=e(33860),he=e(58024),$=e(39144),Oe=e(49111),m=e(19650),Me=e(57663),g=e(71577),o=e(39428),Pe=e(34792),x=e(48086),c=e(3182),Ce=e(47673),J=e(4107),ge=e(71194),V=e(63254),v=e(2824),E=e(67294),Y=e(64918),f=e(85986),k=e(55168),G=e(66415),H=e(58533),z=e(30381),Q=e.n(z),a=e(85893),X=e(48764).Buffer,w="export_cmd",q="excel_path",ee="export_client_path",te="export_server_path",B="setTableConfig",T="tableConfig",y="exportTable",ae="error",S="findSheet",D=[],ne=function(){var re=(0,E.useState)(),A=(0,v.Z)(re,2),i=A[0],R=A[1],se=(0,E.useState)(!1),Z=(0,v.Z)(se,2),W=Z[0],h=Z[1],_e=(0,E.useState)(void 0),L=(0,v.Z)(_e,2),_=L[0],le=L[1],ie=(0,E.useState)([]),U=(0,v.Z)(ie,2),I=U[0],K=U[1],b=(0,E.useRef)(),oe=V.Z.confirm,ue=J.Z.Search,de=function(){var l=(0,c.Z)((0,o.Z)().mark(function n(s){var u,t,d,p,O,M,F,P;return(0,o.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,new Response(s.data).arrayBuffer();case 2:if(u=r.sent,t=JSON.parse(X.from(u).toString()),t.type!=T){r.next=9;break}d=JSON.parse(t.data),le({export_cmd:d.export_cmd||"",excel_path:d.excel_path||"",export_client_path:d.export_client_path||"",export_server_path:d.export_server_path||""}),r.next=29;break;case 9:if(t.type!=B){r.next=13;break}h(!1),r.next=29;break;case 13:if(t.type!=ae){r.next=17;break}x.default.error(t.data),r.next=29;break;case 17:if(t.type!=y){r.next=28;break}if(!(t.data===void 0||t.data==="")){r.next=20;break}return r.abrupt("return");case 20:F=[{title:Q()().format("YYYY-MM-DD HH:mm:ss"),content:t.data}],P=D.concat(F),D=P,K(P),(p=b.current)===null||p===void 0||(O=p.reloadAndRest)===null||O===void 0||O.call(p),(M=document.getElementById("historyScrollDiv"))===null||M===void 0||M.scroll({behavior:"auto",left:0,top:1e5}),r.next=29;break;case 28:t.type==S&&oe({width:700,title:t.data,autoFocusButton:"ok"});case 29:case"end":return r.stop()}},n)}));return function(s){return l.apply(this,arguments)}}(),Ee=function l(){var n=new WebSocket("ws://localhost:9500/exportTable");n.onopen=function(){R(n)},n.onclose=function(){R(void 0),l()},n.onmessage=de};(0,k.QT)((0,c.Z)((0,o.Z)().mark(function l(){return(0,o.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:Ee();case 1:case"end":return s.stop()}},l)}))),(0,E.useEffect)(function(){i!==void 0&&i.send(JSON.stringify({type:T}))},[i]);var ce=function(){var l=(0,c.Z)((0,o.Z)().mark(function n(s){var u;return(0,o.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:u={type:B,data:JSON.stringify(s)},i==null||i.send(JSON.stringify(u));case 2:case"end":return d.stop()}},n)}));return function(s){return l.apply(this,arguments)}}(),ve=function(){var l=(0,c.Z)((0,o.Z)().mark(function n(){return(0,o.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:D=[],K([]),i==null||i.send(JSON.stringify({type:y}));case 3:case"end":return u.stop()}},n)}));return function(){return l.apply(this,arguments)}}(),fe=function(){var l=(0,c.Z)((0,o.Z)().mark(function n(s){return(0,o.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s!==""){t.next=3;break}return x.default.info("\u8BF7\u8F93\u5165\u8868\u683C\u540D\u79F0"),t.abrupt("return");case 3:i==null||i.send(JSON.stringify({type:S,data:s}));case 4:case"end":return t.stop()}},n)}));return function(s){return l.apply(this,arguments)}}();return(0,a.jsxs)(m.Z,{direction:"vertical",style:{width:"100%"},children:[_!==void 0&&(0,a.jsxs)(m.Z,{direction:"vertical",style:{width:"100%"},children:[(0,a.jsx)($.Z,{title:"\u5BFC\u8868",extra:[(0,a.jsxs)(m.Z,{direction:"horizontal",children:[(0,a.jsx)(ue,{placeholder:"\u8BF7\u8F93\u5165\u8981\u67E5\u8BE2\u7684\u8868\u683C\u540D\u79F0",onSearch:fe,style:{width:300},enterButton:"\u67E5\u8BE2"}),(0,a.jsx)(g.Z,{type:"primary",onClick:function(){h(!W)},children:"\u914D\u7F6E"},"config"),(0,a.jsx)(g.Z,{type:"primary",onClick:ve,children:"\u5BFC\u8868"},"export")]},"space")]},"card"),(0,a.jsx)("div",{id:"historyScrollDiv",style:{height:700,overflow:"auto",padding:"0 0",marginLeft:"20%",marginRight:"20%"},children:(0,a.jsx)(H.Z,{next:function(){},hasMore:!1,loader:(0,a.jsx)(N.Z,{avatar:!0,paragraph:{rows:1},active:!0}),dataLength:I.length,scrollableTarget:"historyScrollDiv",children:(0,a.jsx)(G.ZP,{headerTitle:"\u5BFC\u8868\u7ED3\u679C",style:{height:"auto"},dataSource:I,actionRef:b,metas:{description:{dataIndex:"content"}}})})})]})||(0,a.jsx)(j.ZP,{status:"404",title:"404",subTitle:"\u8FDE\u63A5\u8C03\u8BD5\u540E\u53F0\u5931\u8D25,\u65E0\u6CD5\u83B7\u53D6\u914D\u7F6E\u8868\u4FE1\u606F"}),(0,a.jsxs)(Y.Y,{visible:W,onVisibleChange:h,onFinish:ce,name:"\u5BFC\u8868\u914D\u7F6E",children:[(0,a.jsx)(f.Z,{label:"\u5BFC\u8868\u547D\u4EE4",name:w,initialValue:_==null?void 0:_.export_cmd}),(0,a.jsx)(f.Z,{label:"excel\u8DEF\u5F84",name:q,initialValue:_==null?void 0:_.excel_path}),(0,a.jsx)(f.Z,{label:"\u5BA2\u6237\u7AEF\u8868\u683C\u8F93\u51FA\u8DEF\u5F84",name:ee,initialValue:_==null?void 0:_.export_client_path}),(0,a.jsx)(f.Z,{label:"\u670D\u52A1\u7AEF\u8868\u683C\u8F93\u51FA\u8DEF\u5F84",name:te,initialValue:_==null?void 0:_.export_server_path})]})]})};C.default=ne}}]);
